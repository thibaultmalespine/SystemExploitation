<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
</head>
<body>
    <h1>Todo List</h1>

    <!-- Formulaire pour ajouter une nouvelle tâche -->
    <form id="add-task-form">
        <input type="text" id="task-input" placeholder="Nouvelle tâche">
        <button type="submit">Ajouter</button>
    </form>

    <!-- Liste des tâches -->
    <ul id="task-list">
        <!-- Les tâches seront ajoutées ici -->
    </ul>

    <!-- Script JavaScript pour gérer l'interaction avec le backend -->
    <script>
        // Fonction pour récupérer toutes les tâches depuis le backend
        function fetchTasks() {
            fetch('http://localhost:3000/todos')
                .then(response => response.json())
                .then(tasks => {
                    const taskList = document.getElementById('task-list');
                    taskList.innerHTML = ''; // Efface la liste actuelle de tâches

                    tasks.forEach(task => {
                        const listItem = document.createElement('li');
                        listItem.textContent = task.task;
                        taskList.appendChild(listItem);
                    });
                })
                .catch(error => console.error('Erreur lors de la récupération des tâches:', error));
        }

        // Fonction pour ajouter une nouvelle tâche via le backend
        function addTask(task) {
            fetch('http://localhost:3000/todos', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ task: task })
            })
            .then(response => response.json())
            .then(newTask => {
                const taskList = document.getElementById('task-list');
                const listItem = document.createElement('li');
                listItem.textContent = newTask.task;
                taskList.appendChild(listItem);
            })
            .catch(error => console.error('Erreur lors de l\'ajout de la tâche:', error));
        }

        // Événement soumis lorsqu'un utilisateur ajoute une nouvelle tâche
        document.getElementById('add-task-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Empêche le formulaire de se soumettre normalement

            const taskInput = document.getElementById('task-input');
            const newTask = taskInput.value.trim();

            if (newTask !== '') {
                addTask(newTask);
                taskInput.value = ''; // Réinitialise le champ de saisie
            }
        });

        // Charger les tâches initiales lors du chargement de la page
        fetchTasks();
    </script>
</body>
</html>

